<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Smart Home</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.18.1/vis.min.css"></link>
    <link rel="stylesheet" href="index.css"></link>
  <body>
    <div id="app">
      <div id="wrapper">
        <div id="body">
          <p id="light-display">Light: {{light}}</p>
          <div id="temperature-graph-container">
            <canvas id="temperature-graph" width="100px" height="20px"></canvas>
          </div></br>
          <div id="humidity-graph-container">
            <canvas id="humidity-graph" width="100px" height="20px"></canvas>
          </div></br>
          <div id="button1-display"><label class="button-label">Button 1</label></div>
        </div>
      </div>
    </div>


    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.7.3/socket.io.min.js"></script>
    <script src="https://unpkg.com/vue"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.18.1/vis.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
    <script src="./otherstuff.js"></script>

    
    <script type="text/javascript">
      var socket = io();

      var app = new Vue({
        el: '#app',
        data: {
          temperature: '',
          humidity: '',
          light: '',
          button: ''
        }
      });


      $(document).ready(function() {
        socket.emit('get temperature');
        socket.emit('get humidity');
        socket.emit('get light');
        socket.emit('get button');


        // styles

        $('.button-label').center(true);
      });

      // init graphs

      var temperature_data = {
        datasets: [{
          label: "Temperature",
          data: []
        }]
      };
      var humidity_data = {
        datasets: [{
          label: "Humidity",
          data: []
        }]
      };

      socket.on('new temperature', function(temperature) {
        app.temperature = temperature;
        updateTemperatureGraph(temperature);
      });

      socket.on('new humidity', function(humidity) {
        app.humidity = humidity;
        updateHumidityGraph(humidity);
      })

      socket.on('new light', function(light) {
        if (light < 256) {
          app.light = 'it\'s too dark';
        } else if (light < 768) {
          app.light = 'it\'s ok';
        } else {
          app.light = 'it\'s too bright';
        }
      });

      socket.on('new button', function(button) {
        app.button = button;
        if (app.button === '1') {
          $('#button1-display').css('background-color', 'blue');
        } else {
          $('#button1-display').css('background-color', 'black');
        }
      });
    </script>
  </body>
</html>
